{"ast":null,"code":"var _jsxFileName = \"/Users/Nick/Documents/ServeVue/react-auth/with-cookie-auth-fauna/pages/profile.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport cookie from 'cookie';\nimport Router from 'next/router';\nimport { withAuthSync } from '../utils/auth';\nimport { FAUNA_SECRET_COOKIE } from '../utils/fauna-auth';\nimport { profileApi } from './api/profile';\nimport Layout from '../components/layout';\n\nconst Profile = props => {\n  const {\n    userId\n  } = props;\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 5\n    }\n  }, __jsx(\"h1\", {\n    className: \"jsx-1519313982\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 7\n    }\n  }, \"Your user id is \", userId), __jsx(_JSXStyle, {\n    id: \"1519313982\",\n    __self: this\n  }, \"h1.jsx-1519313982{margin-bottom:0;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9OaWNrL0RvY3VtZW50cy9TZXJ2ZVZ1ZS9yZWFjdC1hdXRoL3dpdGgtY29va2llLWF1dGgtZmF1bmEvcGFnZXMvcHJvZmlsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFja0IsQUFHMkIsZ0JBQ2xCIiwiZmlsZSI6Ii9Vc2Vycy9OaWNrL0RvY3VtZW50cy9TZXJ2ZVZ1ZS9yZWFjdC1hdXRoL3dpdGgtY29va2llLWF1dGgtZmF1bmEvcGFnZXMvcHJvZmlsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjb29raWUgZnJvbSAnY29va2llJ1xuaW1wb3J0IFJvdXRlciBmcm9tICduZXh0L3JvdXRlcidcbmltcG9ydCB7IHdpdGhBdXRoU3luYyB9IGZyb20gJy4uL3V0aWxzL2F1dGgnXG5pbXBvcnQgeyBGQVVOQV9TRUNSRVRfQ09PS0lFIH0gZnJvbSAnLi4vdXRpbHMvZmF1bmEtYXV0aCdcbmltcG9ydCB7IHByb2ZpbGVBcGkgfSBmcm9tICcuL2FwaS9wcm9maWxlJ1xuaW1wb3J0IExheW91dCBmcm9tICcuLi9jb21wb25lbnRzL2xheW91dCdcblxuY29uc3QgUHJvZmlsZSA9IHByb3BzID0+IHtcbiAgY29uc3QgeyB1c2VySWQgfSA9IHByb3BzXG5cbiAgcmV0dXJuIChcbiAgICA8TGF5b3V0PlxuICAgICAgPGgxPllvdXIgdXNlciBpZCBpcyB7dXNlcklkfTwvaDE+XG5cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgaDEge1xuICAgICAgICAgIG1hcmdpbi1ib3R0b206IDA7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8L0xheW91dD5cbiAgKVxufVxuXG5Qcm9maWxlLmdldEluaXRpYWxQcm9wcyA9IGFzeW5jIGN0eCA9PiB7XG4gIGNvbnN0IHsgcmVxLCByZXMgfSA9IGN0eFxuICBjb25zb2xlLmxvZyh3aW5kb3cpXG5cbiAgcmV0dXJuIHt1c2VySWQ6ICcxMjMnfVxufVxuXG4vLyBQcm9maWxlLmdldEluaXRpYWxQcm9wcyA9IGFzeW5jIGN0eCA9PiB7XG4vLyAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuLy8gICAgIGNvbnN0IHsgcmVxLCByZXMgfSA9IGN0eFxuLy8gICAgIGNvbnN0IGNvb2tpZXMgPSBjb29raWUucGFyc2UocmVxLmhlYWRlcnMuY29va2llID8/ICcnKVxuLy8gICAgIGNvbnN0IGZhdW5hU2VjcmV0ID0gY29va2llc1tGQVVOQV9TRUNSRVRfQ09PS0lFXVxuXG4vLyAgICAgaWYgKCFmYXVuYVNlY3JldCkge1xuLy8gICAgICAgcmVzLndyaXRlSGVhZCgzMDIsIHsgTG9jYXRpb246ICcvbG9naW4nIH0pXG4vLyAgICAgICByZXMuZW5kKClcbi8vICAgICAgIHJldHVybiB7fVxuLy8gICAgIH1cblxuLy8gICAgIGNvbnN0IHByb2ZpbGVJbmZvID0gYXdhaXQgcHJvZmlsZUFwaShmYXVuYVNlY3JldClcblxuLy8gICAgIHJldHVybiB7IHVzZXJJZDogcHJvZmlsZUluZm8gfVxuLy8gICB9XG5cbi8vICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9wcm9maWxlJylcblxuLy8gICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbi8vICAgICBSb3V0ZXIucHVzaCgnL2xvZ2luJylcbi8vICAgICByZXR1cm4ge31cbi8vICAgfVxuLy8gICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHtcbi8vICAgICB0aHJvdyBuZXcgRXJyb3IoYXdhaXQgcmVzcG9uc2UudGV4dCgpKVxuLy8gICB9XG5cbi8vICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuXG4vLyAgIHJldHVybiB7IHVzZXJJZDogZGF0YS51c2VySWQgfVxuLy8gfVxuXG5leHBvcnQgZGVmYXVsdCB3aXRoQXV0aFN5bmMoUHJvZmlsZSlcbiJdfQ== */\\n/*@ sourceURL=/Users/Nick/Documents/ServeVue/react-auth/with-cookie-auth-fauna/pages/profile.js */\"));\n};\n\nProfile.getInitialProps = async ctx => {\n  const {\n    req,\n    res\n  } = ctx;\n  console.log(window);\n  return {\n    userId: '123'\n  };\n}; // Profile.getInitialProps = async ctx => {\n//   if (typeof window === 'undefined') {\n//     const { req, res } = ctx\n//     const cookies = cookie.parse(req.headers.cookie ?? '')\n//     const faunaSecret = cookies[FAUNA_SECRET_COOKIE]\n//     if (!faunaSecret) {\n//       res.writeHead(302, { Location: '/login' })\n//       res.end()\n//       return {}\n//     }\n//     const profileInfo = await profileApi(faunaSecret)\n//     return { userId: profileInfo }\n//   }\n//   const response = await fetch('/api/profile')\n//   if (response.status === 401) {\n//     Router.push('/login')\n//     return {}\n//   }\n//   if (response.status !== 200) {\n//     throw new Error(await response.text())\n//   }\n//   const data = await response.json()\n//   return { userId: data.userId }\n// }\n\n\nexport default withAuthSync(Profile);","map":{"version":3,"sources":["/Users/Nick/Documents/ServeVue/react-auth/with-cookie-auth-fauna/pages/profile.js"],"names":["cookie","Router","withAuthSync","FAUNA_SECRET_COOKIE","profileApi","Layout","Profile","props","userId","getInitialProps","ctx","req","res","console","log","window"],"mappings":";;;;AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,YAAT,QAA6B,eAA7B;AACA,SAASC,mBAAT,QAAoC,qBAApC;AACA,SAASC,UAAT,QAA2B,eAA3B;AACA,OAAOC,MAAP,MAAmB,sBAAnB;;AAEA,MAAMC,OAAO,GAAGC,KAAK,IAAI;AACvB,QAAM;AAAEC,IAAAA;AAAF,MAAaD,KAAnB;AAEA,SACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAqBC,MAArB,CADF;AAAA;AAAA;AAAA,6+EADF;AAWD,CAdD;;AAgBAF,OAAO,CAACG,eAAR,GAA0B,MAAMC,GAAN,IAAa;AACrC,QAAM;AAAEC,IAAAA,GAAF;AAAOC,IAAAA;AAAP,MAAeF,GAArB;AACAG,EAAAA,OAAO,CAACC,GAAR,CAAYC,MAAZ;AAEA,SAAO;AAACP,IAAAA,MAAM,EAAE;AAAT,GAAP;AACD,CALD,C,CAOA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;;;AAEA,eAAeN,YAAY,CAACI,OAAD,CAA3B","sourcesContent":["import cookie from 'cookie'\nimport Router from 'next/router'\nimport { withAuthSync } from '../utils/auth'\nimport { FAUNA_SECRET_COOKIE } from '../utils/fauna-auth'\nimport { profileApi } from './api/profile'\nimport Layout from '../components/layout'\n\nconst Profile = props => {\n  const { userId } = props\n\n  return (\n    <Layout>\n      <h1>Your user id is {userId}</h1>\n\n      <style jsx>{`\n        h1 {\n          margin-bottom: 0;\n        }\n      `}</style>\n    </Layout>\n  )\n}\n\nProfile.getInitialProps = async ctx => {\n  const { req, res } = ctx\n  console.log(window)\n\n  return {userId: '123'}\n}\n\n// Profile.getInitialProps = async ctx => {\n//   if (typeof window === 'undefined') {\n//     const { req, res } = ctx\n//     const cookies = cookie.parse(req.headers.cookie ?? '')\n//     const faunaSecret = cookies[FAUNA_SECRET_COOKIE]\n\n//     if (!faunaSecret) {\n//       res.writeHead(302, { Location: '/login' })\n//       res.end()\n//       return {}\n//     }\n\n//     const profileInfo = await profileApi(faunaSecret)\n\n//     return { userId: profileInfo }\n//   }\n\n//   const response = await fetch('/api/profile')\n\n//   if (response.status === 401) {\n//     Router.push('/login')\n//     return {}\n//   }\n//   if (response.status !== 200) {\n//     throw new Error(await response.text())\n//   }\n\n//   const data = await response.json()\n\n//   return { userId: data.userId }\n// }\n\nexport default withAuthSync(Profile)\n"]},"metadata":{},"sourceType":"module"}